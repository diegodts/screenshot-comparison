const slugs = ["horizon-gold-card", "citibusiness-aadvantage-platinum-select-world-mastercard", "chase-sapphire-reserve-sm-credit-card-review", "british-airways-visa-signature-card-review", "sdfcu-savings-secured-visa-platinum-card", "barclaycard-cashforward-world-mastercard", "pink-ribbon-bankamericard-cash-rewards", "vast-platinum-card", "capital-one-spark-cash-for-business", "gettington-credit-account", "aadvantage-aviator-red-world-elite-mastercard", "bank-of-america-premium-rewards-credit-card-review", "citi-double-cash-card", "review-gold-delta-skymiles-credit-card-from-american-express", "deserve-classic-mastercard", "review-capital-one-spark-classic-business", "review-boston-store-credit-card", "usaa-secured-card-american-express-credit-card", "review-nfl-extra-points-dallas-cowboys-credit-card", "review-capital-one-quicksilver-rewards-credit-card-date", "review-bealls-credit-card", "indigo-platinum-mastercard", "barclaycard-rewards-mastercard", "review-capital-one-spark-cash-select-for-business", "citi-diamond-preferred-card", "review-navy-federal-credit-union-nrewards-secured-card", "review-wells-fargo-secured-credit-card", "review-the-platinum-card-from-american-express", "excent-secured-credit-card", "review-forever-21-store-credit-card", "simmons-bank-visa-platinum-rewards", "att-access-card-citi-review", "review-united-mileageplus-explorer-business-card", "accountnow-gold-visa-prepaid-card", "review-blue-sky-card-from-american-express", "usaa-rate-advantage-visa-platinum", "wells-fargo-business-secured-credit-card-review", "usaa-military-affiliate-card", "hsbc-cash-rewards-mastercard", "wounded-warrior-project-usaa-rewards-credit-card", "hyatt-credit-card", "jetblue-plus-credit-card", "citi-gold-aadvantage-world-mastercard", "applied-bank-secured-visa-gold-preferred-credit-card", "review-wells-fargo-cash-back-college-card", "best-western-rewards-mastercard", "chase-sapphire-preferred-credit-card-review", "barclaycard-arrival-world-mastercard", "unity-visa-secured-credit-card", "hsbc-platinum-mastercard-rewards-credit-card", "platinum-delta-skymiles-credit-card", "bankamericard-cash-rewards-credit-card", "priceline-rewards-visa-card", "first-access-visa-card-review", "review-world-wildlife-fund-bankamericard-cash-rewards-visa", "review-disney-visa-card", "business-advantage-cash-rewards-mastercard-credit-card", "citi-forward-college-students", "review-mlb-credit-cards", "review-hsbc-platinum-mastercard-credit-card", "review-hilton-honors-card-from-american-express", "chase-ink-business-cash-card-review", "review-blue-cash-preferred-card-from-american-express", "simplycash-plus-business-credit-card-from-american-express", "review-fifth-third-secured-credit-card", "fingerhut-credit-account", "review-ritz-carlton-rewards-credit-card", "review-the-walmart-credit-card-is-worth-it-for-online-shoppers", "bankamericard-credit-card", "milestone-gold-mastercard", "southwest-rapid-rewards-premier-business-credit-card", "bankamericard-travel-rewards-card", "spirit-airlines-world-mastercard", "review-capital-one-secured-mastercard", "luxury-card-mastercard-black-card-review", "citi-simplicity-card", "netfirst-platinum-credit-card-review", "sphere-credit-card", "accountnow-prepaid-visa-card", "review-digital-federal-credit-union-visa-platinum-secured-card", "citi-thankyou-premier-card", "usaa-secured-card-visa-platinum", "frontier-airlines-world-mastercard", "review-capital-one-platinum-credit-card", "luxury-card-mastercard-titanium-card-review", "american-express-green-card", "usaa-cashback-rewards-plus-american-express", "chase-freedom-credit-card", "citi-prestige-credit-card", "marriott-rewards-premier-business-credit-card", "wells-fargo-platinum-card", "barclaycard-arrival-plus-world-elite-mastercard", "att-universal-savings-platinum-card", "chase-freedom-unlimited-credit-card-review", "review-discover-it-credit-card", "costco-anywhere-visa-card-citi", "citi-dividend-platinum-select-visa-card-college-students", "review-goodys-store-credit-card", "asiana-visa-signature-credit-card", "applied-bank-visa-business", "bbt-bright-card", "review-united-mileageplus-club-card", "usaa-classic-visa-platinum-credit-card", "luxe-signature-card", "citi-dividend-platinum-select-visa-card", "united-mileageplus-explorer-credit-card", "deserve-edu-mastercard", "review-hot-topic-guest-list-credit-card", "citi-secured-mastercard", "citi-thankyou-preferred-card-college-students", "primor-secured-mastercard-classic-card-review", "review-norwegian-cruise-line-world-mastercard", "bankamericard-secured-credit-card", "usaa-cash-rewards-visa-signature", "review-blue-cash-card-from-american-express", "review-discover-it-secured-credit-card", "24k-prepaid-visa-rushcard", "barclaycard-ring-mastercard", "hawaiian-airlines-world-elite-mastercard", "allegiant-world-mastercard", "usaa-classic-american-express-credit-card", "review-capital-one-spark-miles-select-for-business", "citi-platinum-select-aadvantage-world-mastercard", "emporium-card", "review-first-progress-platinum-select-mastercard-secured-credit-card", "hsbc-gold-mastercard", "att-universal-savings-rewards-card", "discover-it-miles-travel-credit-card", "next-millennium-card", "review-ink-business-preferred-credit-card", "primor-secured-visa-gold-card", "primor-secured-visa-classic-card", "review-amazon-prime-credit-card", "open-sky-secured-visa-card-review", "amex-everyday-preferred-credit-card-review", "review-gold-card-from-american-express", "review-capital-one-premier-dining-rewards-credit-card", "review-disney-premier-visa-card", "usaa-rewards-visa-signature", "business-platinum-card-from-american-express-review", "credit-one-bank-cash-back-rewards-visa-credit-card-review", "review-capital-one-spark-miles-for-business", "review-delta-reserve-credit-card-from-american-express", "wells-fargo-rewards-card", "review-capital-one-quicksilverone-rewards", "first-progress-platinum-elite-mastercard-credit-card", "marriott-rewards-premier-credit-card", "overstock-store-credit-card", "accountnow-prepaid-mastercard", "target-redcard", "rebuild-your-credit-aeromexico-visa-secured-card", "review-virgin-atlantic-world-elite-mastercard", "wyndham-rewards-visa-credit-card-review", "starwood-hotels-preferred-guest-american-express-card", "fingerhut-advantage-revolving-credit-account", "credit-one-bank-unsecured-platinum-visa-card", "review-lane-bryant-store-credit-card", "citi-executive-aadvantage-world-elite-mastercard", "us-bank-skypass-visa-secured-card", "usaa-rewards-american-express-card", "review-amtrak-guest-rewards-world-mastercard", "barclaycard-nfl-extra-points-credit-card", "uber-visa-card-review", "blue-from-american-express-credit-card", "usaa-cash-rewards-american-express-card", "credit-one-bank-nascar-credit-card-review", "fingerhut-freshstart-credit-account", "first-progress-platinum-secured-mastercard", "review-royal-caribbean-visa-signature-credit-card", "credit-one-bank-unsecured-platinum-visa-credit-card", "luxury-card-mastercard-gold-card-review", "review-u-s-pride-bankamericard-cash-rewards-credit-card", "simmons-bank-visa-platinum", "citibank-thankyou-premier-card", "credit-one-bank-platinum-visa-credit-card", "review-green-dot-platinum-visa", "primor-secured-mastercard-gold-card-review", "review-capital-one-venture-rewards-credit-card", "review-discover-it-chrome-card-for-college-students", "review-amex-everyday-credit-card", "alaska-airlines-visa-signature-card", "southwest-rapid-rewards-plus-credit-card-review", "achievecard-visa-prepaid-review", "usaa-preferred-cash-rewards-visa-signature-card-review", "american-legion-usaa-rewards-visa-signature", "chase-slate-review"];

const slugs2 = ["horizon-gold-card", "citibusiness-aadvantage-platinum-select-world-mastercard", "chase-sapphire-reserve-sm-credit-card-review"]
// slugs.forEach(function(slug) {
//     const url = "https://www.finder.com/" + slug;
//     const fileName = "results/" + slug + ".jpg";
//     console.log('Processing ' + slug + "...")
//     shotFactory.getShot(url).then(buffer => {
//         fs.createWriteStream(fileName)
//             .write(buffer)
//             .end();
//     });
// });

console.clear();
console.log("Starting Screenshot Tool....");
const puppeteer = require('puppeteer');
const puppeteerPool = require('puppeteer-pool')




const { Cluster } = require('puppeteer-cluster');

(async () => {
  const cluster = await Cluster.launch({
    concurrency: Cluster.CONCURRENCY_CONTEXT,
    maxConcurrency: 4,
    monitor: true
  });

  cluster.task(async ({ page, data: slug }) => {
    const url = 'http://finder.com/' + slug;
    const filePath = './images/' + slug + '.png';
    await page.setViewport({ width: 1920, height: 1080 });
    await page.goto(url);
    const screen = await page.screenshot({ path: filePath, fullPage: true });
    console.log('Captured ' + slug);
  });

  slugs.forEach(function(slug) {
    (async() => {
        await cluster.queue(slug);
    })();
});

  cluster.on('taskerror', (err, slug) => {
      console.log(`Error crawling ${slug}: ${err.message}`);
  });

  await cluster.idle();
  await cluster.close();
})();
